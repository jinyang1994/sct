import { expect } from 'chai'
import { decodeFunctionData, NotExistFuncError } from '../src/abi'
import TEST_ABI from './assets/abi.json'

/* eslint-disable max-len */
describe('ABI toolkit', function () {
  it('use ABI decode input data', function () {
    const inputData =
      '0x2e95b6c80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003b9aca00000000000000000000000000000000000000000000000000000002bac0a9d3e80000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d03402e3bb99210ebaa7fae82c32b244e872610107088'
    const decoded = decodeFunctionData(TEST_ABI, inputData)

    expect(decoded.name).to.be.equal('unoswap')
    expect(decoded.inputs.length).to.be.equal(4)
  })

  it('use ABI decode not exist function input data', function () {
    const inputData =
      '0x2e95b6280000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003b9aca00000000000000000000000000000000000000000000000000000002bac0a9d3e80000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000003b6d03402e3bb99210ebaa7fae82c32b244e872610107088'

    try {
      decodeFunctionData(TEST_ABI, inputData)
    } catch (error) {
      expect(error).to.be.instanceOf(NotExistFuncError)
    }
  })
})
